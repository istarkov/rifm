!(function(e, t) {
  'object' == typeof exports && 'undefined' != typeof module
    ? t(exports, require('react'))
    : 'function' == typeof define && define.amd
    ? define(['exports', 'react'], t)
    : t(((e = e || self).Rifm = {}), e.React);
})(this, function(e, t) {
  'use strict';
  (e.Rifm = function(e) {
    var n = t.useReducer(function(e) {
        return e + 1;
      }, 0)[1],
      r = t.useRef(0),
      u = t.useRef(null),
      c = e.replace,
      o = c ? c(e.format(e.value)) : e.format(e.value),
      f = t.useRef(!1);
    return (
      t.useLayoutEffect(function() {
        if (null != u.current) {
          var t = u.current,
            f = t[0],
            a = t[1],
            i = t[2],
            s = t[3],
            l = t[4];
          u.current = null;
          var d = s && l,
            v = function(t) {
              return (t.match(e.accept || /\d/g) || []).join('');
            },
            m = v(f.substr(0, a.selectionStart)),
            h = function(e) {
              for (var t = 0, n = 0, r = 0; r !== m.length; ++r) {
                var u = e.indexOf(m[r], t) + 1,
                  c = v(e).indexOf(m[r], n) + 1;
                c - n > 1 && ((u = t), (c = n)),
                  (n = Math.max(c, n)),
                  (t = Math.max(t, u));
              }
              return t;
            };
          if (!0 === e.mask && i && !l) {
            var p = h(f),
              g = v(f.substr(p))[0];
            (p = f.indexOf(g, p)), (f = '' + f.substr(0, p) + f.substr(p + 1));
          }
          var y = e.format(f),
            x = c ? c(y) : y,
            E = x.length - y.length;
          return (
            (r.current = E > 0 ? E : 0),
            o === x ? n() : e.onChange(x),
            function() {
              var t = h(y);
              if (null != e.mask && (i || (s && !d)))
                for (; y[t] && '' === v(y[t]); ) t += 1;
              a.selectionStart = a.selectionEnd = t + r.current + (d ? 1 : 0);
            }
          );
        }
      }),
      t.useEffect(function() {
        var e = function(e) {
            'Delete' === e.code && (f.current = !0);
          },
          t = function(e) {
            'Delete' === e.code && (f.current = !1);
          };
        return (
          document.addEventListener('keydown', e),
          document.addEventListener('keyup', t),
          function() {
            document.removeEventListener('keydown', e),
              document.removeEventListener('keyup', t);
          }
        );
      }, []),
      e.children({
        value: null != u.current ? u.current[0] : o,
        onChange: function(t) {
          var r = t.target.value;
          (u.current = [
            r,
            t.target,
            r.length > o.length,
            f.current,
            o === e.format(r),
          ]),
            n();
        },
      })
    );
  }),
    Object.defineProperty(e, '__esModule', { value: !0 });
});
